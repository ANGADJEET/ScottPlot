@using SkiaSharp.Views.Blazor;
@using SkiaSharp;
@inherits BlazorPlotBase


<div oncontextmenu="return false;" onmousewheel="return false;" style="width:fit-content; height:fit-content;">
    <SKGLView @ref="SKView" style=@Style OnPaintSurface="OnPaintSurface" IgnorePixelScaling="true" EnableRenderLoop="EnableRenderLoop" 
    @onpointerdown="OnPointerPressed"
    @onpointermove="OnPointerMoved"
    @onpointerup="OnPointerReleased"
    @ondblclick="OnDoubleTapped"
    @onwheel="OnPointerWheelChanged"
    @onkeydown="OnKeyDown"
    @onkeyup="OnKeyUp" />
</div>

@code {

    private SKGLView SKView { get; set; } = new();

    public void OnPaintSurface(SKPaintGLSurfaceEventArgs e)
    {
        Plot.Render(
            canvas: e.Surface.Canvas,
            width: (int)e.Surface.Canvas.LocalClipBounds.Width,
            height: (int)e.Surface.Canvas.LocalClipBounds.Height);
    }

    public override void Refresh()
    {
        SKView.Invalidate();
        RenderQueue.RefreshAll();
    }
}