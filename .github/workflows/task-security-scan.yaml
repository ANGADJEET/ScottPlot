# This workflow evaluates security for code in this repository
# that lives outside the ScottPlot source folder.
# ScottPlot binaries are evaluated in workflows that build and test them.
name: "Security Analysis"

on:
  workflow_dispatch:
  workflow_call:

jobs:
  dependency-scan:
    name: NuGet Dependency Scan
    runs-on: ubuntu-latest
    steps:
      - name: 🛒 Checkout repository
        uses: actions/checkout@v4
      - name: Setup .NET
        uses: actions/setup-dotnet@v4
      - name: SP4 vulnerable package check
        working-directory: ./src/ScottPlot4
        run: dotnet list package --vulnerable
      - name: SP5 vulnerable package check
        working-directory: ./src/ScottPlot5
        run: dotnet list package --vulnerable
  security-scan:
    name: CodeQL Code Scan
    runs-on: ubuntu-latest
    permissions:
      security-events: write
    steps:
      - name: 🛒 Checkout repository
        uses: actions/checkout@v4
      - name: ⚙️ Initialize CodeQL
        uses: github/codeql-action/init@v3
        with:
          languages: python, javascript-typescript
      - name: 🕵️ Analyze
        uses: github/codeql-action/analyze@v3
